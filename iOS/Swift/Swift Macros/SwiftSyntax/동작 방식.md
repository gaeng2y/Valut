SwiftSyntax 라이브러리를 사용하여 Swift 소스 코드 작업의 기본을 알아보자.
### Overview

SwiftSyntax 라이브러리는 Swift 소스 코드를 검사하고 처리하고 수정하는 데 도움을 주는 도구입니다. Swift 코드를 안전하고 효율적으로 다룰 수 있도록 해줍니다. 이 도구를 사용하면 Swift 소스 코드를 쉽게 다룰 수 있어, Swift 문법 분석기나 코드 포매터 같은 도구를 만들 때 유용합니다.

#### 문법 트리
SwiftSyntax는 Swift 소스 코드를 문법 트리라는 구조로 표현합니다. 문법 트리는 **코드의 텍스트와 공백** 뿐만 아니라 **코드 내부의 관계도 표현**합니다.

#### 문법 트리의 세 가지 원칙

1. **불변성**: 문법 트리는 한 번 생성되면 변경되지 않습니다. 트리를 수정하려면 새로운 트리를 만들어야 합니다. 덕분에 여러 스레드에서 동시에 안전하게 사용할 수 있습니다.
   
2. **소스 충실도**: SwiftSyntax는 텍스트뿐만 아니라 공백, 주석, 컴파일러 지시문 같은 모든 정보를 유지합니다. 즉, 원본 소스 코드를 정확하게 재현할 수 있습니다.
   
3. **내구성**: 문법 트리는 잘못된 코드도 표현할 수 있습니다. 예를 들어, 빠진 문법 요소나 예상치 못한 문법 요소도 포함될 수 있습니다.

#### 문법 노드
문법 트리는 문법 노드로 구성됩니다. 문법 노드는 소스 코드의 다양한 요소를 나타냅니다. 예를 들어, 클래스 선언, 함수 호출, 타입, 패턴 등이 있습니다.

#### 문법 토큰
문법 트리의 잎사귀는 문법 토큰입니다. 문법 토큰은 코드의 가장 작은 단위(예: 변수 이름, 연산자 등)를 나타냅니다.

#### 문법 트리 탐색
SwiftSyntax는 문법 트리를 탐색하는 여러 가지 방법을 제공합니다. 각 문법 노드는 부모 노드와 자식 노드에 대한 참조를 가지고 있습니다. 또한, 문법 방문자(SyntaxVisitor)를 사용하여 트리를 순서대로 탐색할 수 있습니다.

#### 문법 트리 수정
문법 트리는 불변이기 때문에, 수정하려면 새로운 문법 트리를 만들어야 합니다. SwiftSyntax는 이런 수정 작업을 쉽게 할 수 있는 여러 가지 메서드를 제공합니다.

#### 문법 트리 생성
SwiftSyntaxBuilder 모듈을 사용하면 문자열 리터럴을 문법 트리로 해석할 수 있습니다. 예를 들어, 다음과 같이 코드를 작성할 수 있습니다:
```swift
import SwiftSyntax
import SwiftParser
import SwiftSyntaxBuilder

let file: SourceFileSyntax = """
print("Hello, world!")
"""
```

#### 함수 생성하기
SwiftSyntax를 사용하여 함수도 쉽게 생성할 수 있습니다. 함수 이름, 매개변수, 반환 타입 등을 지정하여 문법 트리를 만들 수 있습니다. 예를 들어, 이름을 매개변수로 받아서 클래스를 생성하는 함수를 다음과 같이 만들 수 있습니다:
```swift
import SwiftSyntax
import SwiftParser
import SwiftSyntaxBuilder

func createClass(named name: String) -> ClassDeclSyntax {
  return """
         class \(raw: name) {}
         """
}
```

이 함수는 `name`이라는 문자열을 받아서 해당 이름의 클래스를 생성합니다. SwiftSyntaxBuilder를 사용하면 문자열 리터럴과 문자열 보간법을 이용하여 간단하게 문법 트리를 만들 수 있습니다.

이 라이브러리는 Swift 코드를 다루는 도구를 만들 때 매우 유용하며, 다양한 코드 분석 및 변환 작업을 쉽게 할 수 있게 도와줍니다.