## Trouble

ReactorKitì„ ì‚¬ìš© ì¤‘
`mutate` ë©”ì†Œë“œì—ì„œ

```swift
.concat([
    fetchItems(),
    fetchProducts()
])
```

ë¡œ êµ¬í˜„í•˜ê³  

```swift
private func fetchIAPItems() -> Observable<[IAPData]> {
    Observable.create { observer in
        AppLogger.shared.debugLog("ðŸ‘€ \(#function))")
        Api.getIAPList(goods: self.initialState.tab.goods) { response in
            defer {
                observer.onCompleted()
            }
            guard let response,
                  let objects = response["objects"] as? [[AnyHashable: Any]] else {
                return
            }
            
            let iapItems = objects.map(IAPData.init)
            observer.onNext(iapItems)
        } error: { response in
            if let gcode = response?.gcode,
               let message = response?.gcodeMessage {
                observer.onError(Gcode.Failure.validateFailed(gcode: gcode, msg: message))
            } else {
                observer.onCompleted()
            }
        }
        
        return Disposables.create()
    }
}

private func fetchProducts() -> Observable<[Product]> {
    Task {
        AppLogger.shared.debugLog("ðŸ‘€ \(#function))")
        let products = try await Product.products(for: self.currentState.iapItems.map(\.skuCode))
        return products
    }.asObservable()
}
```

ìœ„ì™€ ê°™ì´ êµ¬í˜„í–ˆëŠ”ë° `fetchItems`ê°€ ëë‚˜ê¸° ì „ì— ë¸Œë ˆì´í‚¹í¬ì¸íŠ¸ê°€ fetchProducts() ì˜ ë©”ì†Œë“œê°€ í˜¸ì¶œë˜ì–´ì„œ currentState.iapItemsë¥¼ ì œëŒ€ë¡œ ì°¸ì¡°í•˜ì§€ ëª»í•˜ëŠ” ìƒí™©

ê·¸ëž˜ì„œ ë¡œê·¸ë¥¼ ì‚´íŽ´ë³´ë©´

```
âš’ï¸ [IAPItemListViewController.swift] fetchProducts(130): ðŸ‘€ fetchProducts())
2025-01-23 ì˜¤ì „ 8:17:59.675: ðŸ‘€ fetchItems -> subscribed
âš’ï¸ [IAPItemListViewController.swift] fetchIAPItems(103): ðŸ‘€ fetchIAPItems())
2025-01-23 ì˜¤ì „ 8:17:59.921: ðŸ‘€ fetchItems -> Event next([<idolapp.IAPData: 0x281ef88f0>, <idolapp.IAPData: 0x281ef8a90>, <idolapp.IAPData: 0x281ef8b60>, <idolapp.IAPData: 0x281ef8c30>, <idolapp.IAPData: 0x281ef8d00>, <idolapp.IAPData: 0x281ef8dd0>])
2025-01-23 ì˜¤ì „ 8:17:59.922: ðŸ‘€ fetchItems -> Event completed
2025-01-23 ì˜¤ì „ 8:17:59.922: ðŸ‘€ fetchItems -> isDisposed
2025-01-23 ì˜¤ì „ 8:17:59.923: ðŸ‘€ fetchProducts -> subscribed
2025-01-23 ì˜¤ì „ 8:17:59.926: ðŸ‘€ fetchProducts -> Event next([])
2025-01-23 ì˜¤ì „ 8:17:59.926: ðŸ‘€ fetchProducts -> Event completed
2025-01-23 ì˜¤ì „ 8:17:59.926: ðŸ‘€ fetchProducts -> isDisposed
```

ì´ë ‡ê²Œ í˜¸ì¶œë˜ëŠ” ìƒí™©...

## Solution

Taskë¥¼ í˜¸ì¶œí•˜ê²Œë˜ë©´ concatì´ë¼ë„ ë¨¼ì € í˜¸ì¶œë˜ê¸° ë•Œë¬¸ì— Observable.deferefed í´ë¡œì € ì•ˆì— ë„£ì–´ì„œ í˜¸ì¶œí•´ì•¼í•œë‹¤ (ìˆœì„œë¥¼ ì§€ì¼œì•¼í•œë‹¤ë©´)

```swift
private func fetchProducts() -> Observable<[Product]> {
    .defered {
        Task {
            AppLogger.shared.debugLog("ðŸ‘€ \(#function))")
            let products = try await Product.products(for: self.currentState.iapItems.map(\.skuCode))
            return products
        }.asObservable()
    }
}
```